
      * SAMPLE CUSTOMER VALIDATION PROGRAM
      * THIS PROGRAM VALIDATES CUSTOMER DATA AND PROCESSES ORDERS
       IDENTIFICATION DIVISION.
       PROGRAM-ID. CUSTVAL.
       AUTHOR. SYSTEM ANALYST.
       DATE-WRITTEN. 01/15/2024.
      *
      * BUSINESS REQUIREMENTS:
      * 1. VALIDATE CUSTOMER ID FORMAT (MUST BE 6 DIGITS)
      * 2. CHECK CREDIT LIMIT BEFORE PROCESSING ORDER
      * 3. UPDATE CUSTOMER STATUS BASED ON PAYMENT HISTORY
      *
       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT CUSTOMER-FILE ASSIGN TO "CUSTDATA.DAT"
           ORGANIZATION IS SEQUENTIAL.
       
       DATA DIVISION.
       FILE SECTION.
       FD CUSTOMER-FILE.
       01 CUSTOMER-RECORD.
          05 CUST-ID          PIC 9(6).
          05 CUST-NAME        PIC X(30).
          05 CREDIT-LIMIT     PIC 9(7)V99.
          05 CURRENT-BALANCE  PIC 9(7)V99.
          05 STATUS-CODE      PIC X(1).
       
       WORKING-STORAGE SECTION.
       01 WS-VALIDATION-FLAGS.
          05 VALID-CUSTOMER   PIC X(1) VALUE 'N'.
          05 CREDIT-OK        PIC X(1) VALUE 'N'.
       
       PROCEDURE DIVISION.
       MAIN-PROCESS.
           PERFORM VALIDATE-CUSTOMER-ID
           IF VALID-CUSTOMER = 'Y'
              PERFORM CHECK-CREDIT-LIMIT
              IF CREDIT-OK = 'Y'
                 PERFORM PROCESS-ORDER
              ELSE
                 DISPLAY 'CREDIT LIMIT EXCEEDED'
              END-IF
           ELSE
              DISPLAY 'INVALID CUSTOMER ID'
           END-IF.
           STOP RUN.
       
       VALIDATE-CUSTOMER-ID.
      * BUSINESS RULE: CUSTOMER ID MUST BE 6 DIGITS
           IF CUST-ID IS NUMERIC AND CUST-ID > 100000
              MOVE 'Y' TO VALID-CUSTOMER
           ELSE
              MOVE 'N' TO VALID-CUSTOMER
           END-IF.
